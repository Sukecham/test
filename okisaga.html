import React, { useState, useCallback, useEffect, useRef } from â€˜reactâ€™;

// åŠ¹æœéŸ³ç”Ÿæˆ
const useSound = () => {
const audioCtx = useRef(null);

const getCtx = () => {
if (!audioCtx.current) {
audioCtx.current = new (window.AudioContext || window.webkitAudioContext)();
}
return audioCtx.current;
};

const play = (type) => {
try {
const ctx = getCtx();
const osc = ctx.createOscillator();
const gain = ctx.createGain();
osc.connect(gain);
gain.connect(ctx.destination);

```
  switch (type) {
    case 'attack':
      osc.frequency.setValueAtTime(200, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.1);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
      osc.start(); osc.stop(ctx.currentTime + 0.1);
      break;
    case 'hit':
      osc.frequency.setValueAtTime(150, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(50, ctx.currentTime + 0.15);
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
      osc.start(); osc.stop(ctx.currentTime + 0.15);
      break;
    case 'critical':
      osc.type = 'sawtooth';
      osc.frequency.setValueAtTime(400, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(800, ctx.currentTime + 0.1);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
      osc.start(); osc.stop(ctx.currentTime + 0.15);
      break;
    case 'win':
      osc.type = 'sine';
      [523, 659, 784, 1047].forEach((f, i) => {
        osc.frequency.setValueAtTime(f, ctx.currentTime + i * 0.12);
      });
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
      osc.start(); osc.stop(ctx.currentTime + 0.5);
      break;
    case 'lose':
      osc.type = 'sine';
      osc.frequency.setValueAtTime(300, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(100, ctx.currentTime + 0.5);
      gain.gain.setValueAtTime(0.25, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
      osc.start(); osc.stop(ctx.currentTime + 0.5);
      break;
    case 'levelup':
      osc.type = 'sine';
      [440, 554, 659, 880].forEach((f, i) => {
        osc.frequency.setValueAtTime(f, ctx.currentTime + i * 0.1);
      });
      gain.gain.setValueAtTime(0.25, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
      osc.start(); osc.stop(ctx.currentTime + 0.5);
      break;
    case 'gacha':
      osc.type = 'triangle';
      osc.frequency.setValueAtTime(300, ctx.currentTime);
      osc.frequency.linearRampToValueAtTime(600, ctx.currentTime + 0.5);
      gain.gain.setValueAtTime(0.15, ctx.currentTime);
      gain.gain.linearRampToValueAtTime(0.3, ctx.currentTime + 0.5);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.6);
      osc.start(); osc.stop(ctx.currentTime + 0.6);
      break;
    case 'gachaHit':
      osc.type = 'sine';
      [880, 1108, 1318, 1760].forEach((f, i) => {
        osc.frequency.setValueAtTime(f, ctx.currentTime + i * 0.08);
      });
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
      osc.start(); osc.stop(ctx.currentTime + 0.4);
      break;
    case 'gachaRare':
      osc.type = 'sine';
      for (let i = 0; i < 8; i++) {
        osc.frequency.setValueAtTime(600 + i * 100, ctx.currentTime + i * 0.06);
      }
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.6);
      osc.start(); osc.stop(ctx.currentTime + 0.6);
      break;
    case 'button':
      osc.frequency.setValueAtTime(800, ctx.currentTime);
      gain.gain.setValueAtTime(0.1, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
      osc.start(); osc.stop(ctx.currentTime + 0.05);
      break;
    case 'heal':
      osc.type = 'sine';
      osc.frequency.setValueAtTime(523, ctx.currentTime);
      osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
      osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
      osc.start(); osc.stop(ctx.currentTime + 0.3);
      break;
    case 'boss':
      osc.type = 'sawtooth';
      osc.frequency.setValueAtTime(80, ctx.currentTime);
      osc.frequency.setValueAtTime(60, ctx.currentTime + 0.2);
      osc.frequency.setValueAtTime(80, ctx.currentTime + 0.4);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
      osc.start(); osc.stop(ctx.currentTime + 0.5);
      break;
    default:
      break;
  }
} catch (e) {}
```

};
return play;
};

// è·æ¥­å®šç¾©
const JOBS = {
fisherman: { name: â€˜æ¼å¸«â€™, icon: â€˜ğŸ£â€™, color: â€˜#4169E1â€™, baseAtk: 12, baseDef: 8, baseHp: 110, special: â€˜shellâ€™, rarity: â€˜Nâ€™ },
salaryman: { name: â€˜ã‚µãƒ©ãƒªãƒ¼ãƒãƒ³â€™, icon: â€˜ğŸ‘”â€™, color: â€˜#708090â€™, baseAtk: 10, baseDef: 10, baseHp: 100, special: â€˜expâ€™, rarity: â€˜Nâ€™ },
sumo: { name: â€˜åŠ›å£«â€™, icon: â€˜ğŸ¤¼â€™, color: â€˜#8B4513â€™, baseAtk: 15, baseDef: 5, baseHp: 180, special: â€˜counterâ€™, rarity: â€˜Râ€™ },
doctor: { name: â€˜åŒ»è€…â€™, icon: â€˜ğŸ‘¨â€âš•ï¸â€™, color: â€˜#00CED1â€™, baseAtk: 8, baseDef: 12, baseHp: 100, special: â€˜healâ€™, rarity: â€˜Râ€™ },
diver: { name: â€˜æµ·å¥³â€™, icon: â€˜ğŸ¤¿â€™, color: â€˜#20B2AAâ€™, baseAtk: 14, baseDef: 6, baseHp: 90, special: â€˜critâ€™, rarity: â€˜Râ€™ },
chef: { name: â€˜æ–™ç†äººâ€™, icon: â€˜ğŸ‘¨â€ğŸ³â€™, color: â€˜#FF6347â€™, baseAtk: 10, baseDef: 8, baseHp: 95, special: â€˜itemâ€™, rarity: â€˜SRâ€™ },
shrine: { name: â€˜ç¥ä¸»â€™, icon: â€˜â›©ï¸â€™, color: â€˜#9932CCâ€™, baseAtk: 11, baseDef: 11, baseHp: 105, special: â€˜divineâ€™, rarity: â€˜SRâ€™ },
captain: { name: â€˜èˆ¹é•·â€™, icon: â€˜ğŸš¢â€™, color: â€˜#FFD700â€™, baseAtk: 13, baseDef: 13, baseHp: 120, special: â€˜doubleâ€™, rarity: â€˜SSRâ€™ },
emperor: { name: â€˜å¾Œé³¥ç¾½ä¸Šçš‡â€™, icon: â€˜ğŸ‘‘â€™, color: â€˜#FF4500â€™, baseAtk: 18, baseDef: 15, baseHp: 150, special: â€˜pierceâ€™, rarity: â€˜SSRâ€™ },
dragon: { name: â€˜é¾ç¥â€™, icon: â€˜ğŸ‰â€™, color: â€˜#00FF7Fâ€™, baseAtk: 25, baseDef: 20, baseHp: 200, special: â€˜allâ€™, rarity: â€˜URâ€™ },
};
const JOB_IDS = Object.keys(JOBS);

const SHELLS = {
1: { name: â€˜ã‚·ã‚¸ãƒŸâ€™, color: â€˜#8B7355â€™, icon: â€˜ğŸšâ€™, itemCost: 10, jobCost: 15 },
2: { name: â€˜ã‚¢ã‚µãƒªâ€™, color: â€˜#CD853Fâ€™, icon: â€˜ğŸ¦ªâ€™, itemCost: 8, jobCost: 12 },
3: { name: â€˜ãƒãƒã‚°ãƒªâ€™, color: â€˜#DAA520â€™, icon: â€˜ğŸšâ€™, itemCost: 5, jobCost: 8 },
4: { name: â€˜ã‚µã‚¶ã‚¨â€™, color: â€˜#228B22â€™, icon: â€˜ğŸšâ€™, itemCost: 3, jobCost: 5 },
5: { name: â€˜ã‚¢ãƒ¯ãƒ“â€™, color: â€˜#4169E1â€™, icon: â€˜ğŸ¦ªâ€™, itemCost: 1, jobCost: 2 },
};

// æ•µå®šç¾©ï¼ˆé€šå¸¸ï¼‹ãƒœã‚¹ï¼‰- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦ã‚¹ã‚±ãƒ¼ãƒ«
const ENEMIES = [
// é€šå¸¸æ•µ
{ name: â€˜ã‚¦ãƒ‹â€™, hp: 30, atk: 8, def: 3, exp: 15, drop: [1,1,1,2], color: â€˜#8B008Bâ€™, icon: â€˜ğŸ¦”â€™, lv: 1, boss: false },
{ name: â€˜ãƒ’ãƒˆãƒ‡â€™, hp: 45, atk: 12, def: 4, exp: 25, drop: [1,2,2,2], color: â€˜#FF6347â€™, icon: â€˜â­â€™, lv: 1, boss: false },
{ name: â€˜ã‚¯ãƒ©ã‚²â€™, hp: 40, atk: 15, def: 2, exp: 20, drop: [1,1,2,2], color: â€˜#FFB6C1â€™, icon: â€˜ğŸª¼â€™, lv: 2, boss: false },
{ name: â€˜ã‚¿ã‚³â€™, hp: 80, atk: 22, def: 8, exp: 45, drop: [2,2,3,3], color: â€˜#FF4500â€™, icon: â€˜ğŸ™â€™, lv: 5, boss: false },
{ name: â€˜ã‚«ãƒ‹â€™, hp: 100, atk: 18, def: 20, exp: 55, drop: [2,2,3,3], color: â€˜#DC143Câ€™, icon: â€˜ğŸ¦€â€™, lv: 6, boss: false },
{ name: â€˜ã‚µãƒ¡â€™, hp: 180, atk: 40, def: 15, exp: 120, drop: [3,3,4,4], color: â€˜#4682B4â€™, icon: â€˜ğŸ¦ˆâ€™, lv: 10, boss: false },
{ name: â€˜ã‚¦ãƒŸã‚¬ãƒ¡â€™, hp: 220, atk: 30, def: 35, exp: 130, drop: [3,4,4,4], color: â€˜#2E8B57â€™, icon: â€˜ğŸ¢â€™, lv: 12, boss: false },
{ name: â€˜ã‚·ãƒ£ãƒâ€™, hp: 280, atk: 55, def: 25, exp: 180, drop: [3,4,4,5], color: â€˜#1C1C1Câ€™, icon: â€˜ğŸ‹â€™, lv: 15, boss: false },
{ name: â€˜å¤§ç‹ã‚¤ã‚«â€™, hp: 380, atk: 70, def: 30, exp: 250, drop: [4,4,5,5], color: â€˜#800080â€™, icon: â€˜ğŸ¦‘â€™, lv: 20, boss: false },
{ name: â€˜ãƒ¡ã‚¬ãƒ­ãƒ‰ãƒ³â€™, hp: 550, atk: 95, def: 45, exp: 400, drop: [4,5,5,5], color: â€˜#696969â€™, icon: â€˜ğŸ¦ˆâ€™, lv: 28, boss: false },
{ name: â€˜æµ·åŠä¸»â€™, hp: 750, atk: 110, def: 55, exp: 550, drop: [5,5,5,5], color: â€˜#191970â€™, icon: â€˜ğŸ‘¹â€™, lv: 35, boss: false },
{ name: â€˜æµ·ç¥ãƒ¯ãƒ€ãƒ„ãƒŸâ€™, hp: 1200, atk: 150, def: 80, exp: 1000, drop: [5,5,5,5], color: â€˜#00CED1â€™, icon: â€˜ğŸ”±â€™, lv: 45, boss: false },

// ãƒœã‚¹æ•µï¼ˆè‰²é•ã„ãƒ»å¼·åŒ–ç‰ˆï¼‰
{ name: â€˜æ¯’ã‚­ãƒ³ã‚°ã‚¦ãƒ‹â€™, hp: 80, atk: 20, def: 8, exp: 50, drop: [2,2,2,3], color: â€˜#FF00FFâ€™, icon: â€˜ğŸ¦”â€™, lv: 3, boss: true, glow: â€˜#FF00FFâ€™ },
{ name: â€˜ç¼ç†±ãƒ’ãƒˆãƒ‡â€™, hp: 120, atk: 30, def: 10, exp: 80, drop: [2,2,3,3], color: â€˜#FF4500â€™, icon: â€˜â­â€™, lv: 5, boss: true, glow: â€˜#FF4500â€™ },
{ name: â€˜é›»æ’ƒã‚¯ãƒ©ã‚²â€™, hp: 100, atk: 40, def: 5, exp: 70, drop: [2,3,3,3], color: â€˜#00FFFFâ€™, icon: â€˜ğŸª¼â€™, lv: 6, boss: true, glow: â€˜#00FFFFâ€™ },
{ name: â€˜æ·±æµ·å¤§ãƒ€ã‚³â€™, hp: 200, atk: 55, def: 18, exp: 150, drop: [3,3,4,4], color: â€˜#8B0000â€™, icon: â€˜ğŸ™â€™, lv: 10, boss: true, glow: â€˜#FF0000â€™ },
{ name: â€˜é‹¼é‰„ã‚«ãƒ‹â€™, hp: 250, atk: 45, def: 50, exp: 180, drop: [3,4,4,4], color: â€˜#C0C0C0â€™, icon: â€˜ğŸ¦€â€™, lv: 12, boss: true, glow: â€˜#FFFFFFâ€™ },
{ name: â€˜ç™½é¯¨ã‚·ãƒ£ãƒ¼ã‚¯â€™, hp: 400, atk: 90, def: 35, exp: 350, drop: [4,4,5,5], color: â€˜#F0F8FFâ€™, icon: â€˜ğŸ¦ˆâ€™, lv: 18, boss: true, glow: â€˜#87CEEBâ€™ },
{ name: â€˜ç„æ­¦â€™, hp: 500, atk: 70, def: 80, exp: 400, drop: [4,4,5,5], color: â€˜#006400â€™, icon: â€˜ğŸ¢â€™, lv: 22, boss: true, glow: â€˜#00FF00â€™ },
{ name: â€˜è¦‡ç‹ã‚·ãƒ£ãƒâ€™, hp: 650, atk: 130, def: 50, exp: 550, drop: [4,5,5,5], color: â€˜#4B0082â€™, icon: â€˜ğŸ‹â€™, lv: 28, boss: true, glow: â€˜#9400D3â€™ },
{ name: â€˜ã‚¯ãƒ©ãƒ¼ã‚±ãƒ³â€™, hp: 900, atk: 160, def: 60, exp: 800, drop: [5,5,5,5], color: â€˜#2F0040â€™, icon: â€˜ğŸ¦‘â€™, lv: 35, boss: true, glow: â€˜#8B008Bâ€™ },
{ name: â€˜å¤ä»£ãƒ¡ã‚¬ãƒ­ãƒ‰ãƒ³â€™, hp: 1300, atk: 200, def: 80, exp: 1200, drop: [5,5,5,5], color: â€˜#1a1a1aâ€™, icon: â€˜ğŸ¦ˆâ€™, lv: 42, boss: true, glow: â€˜#FFD700â€™ },
{ name: â€˜æš´é¢¨æµ·åŠä¸»â€™, hp: 1800, atk: 250, def: 100, exp: 1800, drop: [5,5,5,5], color: â€˜#000033â€™, icon: â€˜ğŸ‘¹â€™, lv: 48, boss: true, glow: â€˜#00BFFFâ€™ },
{ name: â€˜é¾å®®ã®ç‹â€™, hp: 3000, atk: 350, def: 150, exp: 3000, drop: [5,5,5,5], color: â€˜#FFD700â€™, icon: â€˜ğŸ‘‘â€™, lv: 55, boss: true, glow: â€˜#FFD700â€™ },
];

// éš å²ã‚‰ã—ã„è£…å‚™
const ITEMS = {
1: [
{ id: â€˜w1aâ€™, name: â€˜æ¼å¸«ã®éŠ›â€™, type: â€˜Wâ€™, rarity: â€˜Nâ€™, atk: 3, def: 0, hp: 0 },
{ id: â€˜a1aâ€™, name: â€˜è—ç·¨ã¿ã®èƒ´ç€â€™, type: â€˜Aâ€™, rarity: â€˜Nâ€™, atk: 0, def: 3, hp: 5 },
{ id: â€˜w1bâ€™, name: â€˜è²æ®»ã®å°åˆ€â€™, type: â€˜Wâ€™, rarity: â€˜Râ€™, atk: 5, def: 0, hp: 0 },
{ id: â€˜a1bâ€™, name: â€˜æµ·è—»ã®ç¾½ç¹”â€™, type: â€˜Aâ€™, rarity: â€˜Râ€™, atk: 0, def: 4, hp: 10 },
{ id: â€˜c1aâ€™, name: â€˜ç™½å³¶ã®è­·çŸ³â€™, type: â€˜Câ€™, rarity: â€˜SRâ€™, atk: 3, def: 3, hp: 15 },
],
2: [
{ id: â€˜w2aâ€™, name: â€˜éš å²æ‰ã®æ£æ£’â€™, type: â€˜Wâ€™, rarity: â€˜Nâ€™, atk: 6, def: 0, hp: 0 },
{ id: â€˜a2aâ€™, name: â€˜ç‰›çš®ã®èƒ¸å½“ã¦â€™, type: â€˜Aâ€™, rarity: â€˜Nâ€™, atk: 0, def: 6, hp: 10 },
{ id: â€˜w2bâ€™, name: â€˜ã‚¤ã‚«é‡£ã‚Šã®é‰¤æ§â€™, type: â€˜Wâ€™, rarity: â€˜Râ€™, atk: 10, def: 0, hp: 0 },
{ id: â€˜a2bâ€™, name: â€˜ä¸­ãƒå³¶ã®æ¼å¸«åˆç¾½â€™, type: â€˜Aâ€™, rarity: â€˜Râ€™, atk: 0, def: 8, hp: 15 },
{ id: â€˜c2aâ€™, name: â€˜è¥¿éƒ·æ¹¾ã®çœŸç â€™, type: â€˜Câ€™, rarity: â€˜SRâ€™, atk: 5, def: 5, hp: 25 },
],
3: [
{ id: â€˜w3aâ€™, name: â€˜çŸ¥å¤«é‡Œã®é¯¨éª¨åˆ€â€™, type: â€˜Wâ€™, rarity: â€˜Râ€™, atk: 15, def: 0, hp: 0 },
{ id: â€˜a3aâ€™, name: â€˜ã‚µã‚¶ã‚¨æ®»ã®é§â€™, type: â€˜Aâ€™, rarity: â€˜Râ€™, atk: 0, def: 15, hp: 20 },
{ id: â€˜w3bâ€™, name: â€˜æµ·å£«ã®ä¸‰å‰æ§â€™, type: â€˜Wâ€™, rarity: â€˜SRâ€™, atk: 20, def: 0, hp: 0 },
{ id: â€˜a3bâ€™, name: â€˜ç‰›çªãã®åŒ–ç²§å»»ã—â€™, type: â€˜Aâ€™, rarity: â€˜SRâ€™, atk: 5, def: 12, hp: 30 },
{ id: â€˜c3aâ€™, name: â€˜ç‰è‹¥é…¢å‘½ã®å‹¾ç‰â€™, type: â€˜Câ€™, rarity: â€˜SSRâ€™, atk: 10, def: 10, hp: 40 },
],
4: [
{ id: â€˜w4aâ€™, name: â€˜é»’æ›œçŸ³ã®å¤ªåˆ€â€™, type: â€˜Wâ€™, rarity: â€˜SRâ€™, atk: 30, def: 0, hp: 0 },
{ id: â€˜a4aâ€™, name: â€˜æ‘©å¤©å´–ã®å²©é§â€™, type: â€˜Aâ€™, rarity: â€˜SRâ€™, atk: 0, def: 30, hp: 35 },
{ id: â€˜w4bâ€™, name: â€˜åœ‹è³€ç¥ç¤¾ã®ç¥å‰£â€™, type: â€˜Wâ€™, rarity: â€˜SSRâ€™, atk: 40, def: 5, hp: 0 },
{ id: â€˜a4bâ€™, name: â€˜ç„¼ç«ç¥ç¤¾ã®ç¥è¡£â€™, type: â€˜Aâ€™, rarity: â€˜SSRâ€™, atk: 5, def: 35, hp: 50 },
{ id: â€˜c4aâ€™, name: â€˜ãƒ­ãƒ¼ã‚½ã‚¯å³¶ã®è–ç«â€™, type: â€˜Câ€™, rarity: â€˜URâ€™, atk: 20, def: 20, hp: 60 },
],
5: [
{ id: â€˜w5aâ€™, name: â€˜å¾Œé³¥ç¾½é™¢ã®å¾¡å‰£â€™, type: â€˜Wâ€™, rarity: â€˜SSRâ€™, atk: 50, def: 5, hp: 0 },
{ id: â€˜a5aâ€™, name: â€˜æ‰¿ä¹…ã®æˆ¦è£…æŸâ€™, type: â€˜Aâ€™, rarity: â€˜SSRâ€™, atk: 5, def: 50, hp: 60 },
{ id: â€˜w5bâ€™, name: â€˜é¾ç¥ã®ä¸‰å‰æˆŸâ€™, type: â€˜Wâ€™, rarity: â€˜URâ€™, atk: 65, def: 10, hp: 20 },
{ id: â€˜a5bâ€™, name: â€˜éš å²å›½é€ ã®å¤§é§â€™, type: â€˜Aâ€™, rarity: â€˜URâ€™, atk: 10, def: 60, hp: 80 },
{ id: â€˜c5aâ€™, name: â€˜å³¶å‰å³¶å¾Œã®ç¥ç’½â€™, type: â€˜Câ€™, rarity: â€˜LRâ€™, atk: 40, def: 40, hp: 100 },
],
};
const ALL_ITEMS = Object.values(ITEMS).flat();

const RARITY_COLOR = { N: â€˜#808080â€™, R: â€˜#4169E1â€™, SR: â€˜#9932CCâ€™, SSR: â€˜#FFD700â€™, UR: â€˜#FF4500â€™, LR: â€˜#00FF7Fâ€™ };
const RARITY_LIST = [â€˜Nâ€™, â€˜Râ€™, â€˜SRâ€™, â€˜SSRâ€™, â€˜URâ€™, â€˜LRâ€™];
const TYPE_ICON = { W: â€˜âš”ï¸â€™, A: â€˜ğŸ›¡ï¸â€™, C: â€˜ğŸ’â€™ };
const TYPE_NAME = { W: â€˜æ­¦å™¨â€™, A: â€˜é˜²å…·â€™, C: â€˜è£…é£¾â€™ };

const ITEM_RATES = { 1: [.4,.35,.25,0,0], 2: [.35,.35,.3,0,0], 3: [0,.35,.4,.25,0], 4: [0,0,.4,.45,.15], 5: [0,0,.3,.45,.25] };
const JOB_RATES = { 1: {N:.8,R:.18,SR:.02}, 2: {N:.6,R:.35,SR:.05}, 3: {N:.3,R:.5,SR:.18,SSR:.02}, 4: {N:.1,R:.3,SR:.45,SSR:.14,UR:.01}, 5: {R:.1,SR:.4,SSR:.4,UR:.1} };

const SPELL = â€˜ã‚ã„ã†ãˆãŠã‹ããã‘ã“ã•ã—ã™ã›ããŸã¡ã¤ã¦ã¨ãªã«ã¬ã­ã®ã¯ã²ãµã¸ã»ã¾ã¿ã‚€ã‚ã‚‚ã‚„ã‚†ã‚ˆã‚‰ã‚Šã‚‹ã‚Œã‚ã‚ã‚’ã‚“â€™;

const encode = (p) => {
let d = [p.level, p.exp % 47, Math.floor(p.exp / 47) % 47, JOB_IDS.indexOf(p.currentJob)];
let jf = 0; p.unlockedJobs.forEach(j => jf |= 1 << JOB_IDS.indexOf(j)); d.push(jf % 47, Math.floor(jf / 47) % 47);
for (let i = 1; i <= 5; i++) d.push(p.shells[i] % 47);
JOB_IDS.forEach(j => d.push((p.jobLevels[j] || 1) - 1));
d.push(p.items.length);
p.items.forEach(it => { d.push(ALL_ITEMS.findIndex(x => x.id === it.id)); d.push((it.lv || 1) - 1); });
d.push(d.reduce((a, b) => a + b, 0) % 47);
return d.map(n => SPELL[n % 47]).join(â€™â€™);
};

const decode = (s) => {
try {
const c = s.replace(/\s/g, â€˜â€™).split(â€™â€™).map(x => SPELL.indexOf(x));
let i = 0;
const level = c[i++], exp = c[i++] + c[i++] * 47, currentJob = JOB_IDS[c[i++]];
const jf = c[i++] + c[i++] * 47;
const unlockedJobs = JOB_IDS.filter((_, idx) => jf & (1 << idx));
if (!unlockedJobs.includes(â€˜fishermanâ€™)) unlockedJobs.push(â€˜fishermanâ€™);
const shells = {}; for (let j = 1; j <= 5; j++) shells[j] = c[i++];
const jobLevels = {}; JOB_IDS.forEach(j => jobLevels[j] = c[i++] + 1);
const itemCount = c[i++], items = [];
for (let j = 0; j < itemCount; j++) { const it = ALL_ITEMS[c[i++]]; if (it) items.push({ â€¦it, lv: c[i++] + 1 }); else i++; }
return { level, exp, currentJob, unlockedJobs, shells, jobLevels, items };
} catch { return null; }
};

export default function Game() {
const [screen, setScreen] = useState(â€˜titleâ€™);
const [player, setPlayer] = useState({
level: 1, exp: 0, currentJob: â€˜fishermanâ€™,
unlockedJobs: [â€˜fishermanâ€™, â€˜salarymanâ€™],
shells: { 1: 5, 2: 3, 3: 1, 4: 0, 5: 0 },
jobLevels: { fisherman: 1, salaryman: 1 },
items: [],
});
const [hp, setHp] = useState(null);
const [enemy, setEnemy] = useState(null);
const [log, setLog] = useState([]);
const [anim, setAnim] = useState(false);
const [tab, setTab] = useState(â€˜gachaâ€™);
const [gachaPhase, setGachaPhase] = useState(null);
const [gachaType, setGachaType] = useState(null);
const [gachaRank, setGachaRank] = useState(null);
const [gachaRarity, setGachaRarity] = useState(null);
const [result, setResult] = useState(null);
const [showPw, setShowPw] = useState(false);
const [pwInput, setPwInput] = useState(â€™â€™);
const [pwError, setPwError] = useState(â€™â€™);
const [showPwInput, setShowPwInput] = useState(false);

const sound = useSound();
const job = JOBS[player.currentJob];
const jLv = player.jobLevels[player.currentJob] || 1;
const jBonus = 1 + (jLv - 1) * 0.15;
const spBonus = 15 + (jLv - 1) * 8;

const getStats = useCallback(() => {
let atk = Math.floor((job.baseAtk + (player.level - 1) * 3) * jBonus);
let def = Math.floor((job.baseDef + (player.level - 1) * 2) * jBonus);
let mhp = Math.floor((job.baseHp + (player.level - 1) * 20) * jBonus);
player.items.forEach(it => {
const b = 1 + ((it.lv || 1) - 1) * 0.25;
atk += Math.floor(it.atk * b);
def += Math.floor(it.def * b);
mhp += Math.floor(it.hp * b);
});
if (job.special === â€˜itemâ€™ || job.special === â€˜allâ€™) { atk = Math.floor(atk * (1 + spBonus / 100)); def = Math.floor(def * (1 + spBonus / 100)); }
if (job.special === â€˜divineâ€™ || job.special === â€˜allâ€™) { atk = Math.floor(atk * 1.1); def = Math.floor(def * 1.1); mhp = Math.floor(mhp * 1.1); }
return { atk, def, mhp };
}, [player, job, jBonus, spBonus]);

const stats = getStats();
const maxHp = stats.mhp;
const curHp = hp ?? maxHp;

useEffect(() => { if (hp === null) setHp(maxHp); }, [hp, maxHp]);

const expNext = (lv) => Math.floor(lv * 50 * (1 + lv * 0.1));

// æ•µã®ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦å¼·åŒ–ï¼‰
const scaleEnemy = (base, playerLv) => {
const lvDiff = playerLv - base.lv;
const scale = 1 + Math.max(0, lvDiff) * 0.12; // ãƒ¬ãƒ™ãƒ«å·®1ã«ã¤ã12%å¼·åŒ–
const bossScale = base.boss ? 1.5 : 1; // ãƒœã‚¹ã¯1.5å€
return {
â€¦base,
maxHp: Math.floor(base.hp * scale * bossScale),
hp: Math.floor(base.hp * scale * bossScale),
atk: Math.floor(base.atk * scale * bossScale),
def: Math.floor(base.def * scale * bossScale),
exp: Math.floor(base.exp * scale * (base.boss ? 2 : 1)),
};
};

const startBattle = () => {
sound(â€˜buttonâ€™);
if (curHp <= 0) setHp(maxHp);

```
// ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ãŸæ•µã‚’é¸æŠï¼ˆãƒœã‚¹20%å‡ºç¾ï¼‰
const isBoss = Math.random() < 0.2;
const availEnemies = ENEMIES.filter(e => e.boss === isBoss && e.lv <= player.level + 8 && e.lv >= player.level - 10);
const fallback = ENEMIES.filter(e => e.boss === isBoss);
const pool = availEnemies.length > 0 ? availEnemies : fallback;
const base = pool[Math.floor(Math.random() * pool.length)];
const scaled = scaleEnemy(base, player.level);

if (scaled.boss) sound('boss');
setEnemy(scaled);
setLog([`${scaled.boss ? 'âš ï¸ BOSS! ' : ''}${scaled.name}ãŒç¾ã‚ŒãŸï¼`]);
setScreen('battle');
```

};

const doAttack = () => {
if (!enemy || anim) return;
setAnim(true);
sound(â€˜attackâ€™);

```
const sp = job.special;
let dmg = Math.max(1, stats.atk - Math.floor(enemy.def / ((sp === 'pierce' || sp === 'all') ? 3 : 2)));
const isCrit = Math.random() < ((sp === 'crit' || sp === 'all') ? spBonus / 100 : 0.05);
if (isCrit) { dmg = Math.floor(dmg * 1.5); sound('critical'); }
const bonus = Math.random() < ((sp === 'double' || sp === 'all') ? spBonus / 100 : 0) ? Math.floor(dmg * 0.5) : 0;
const eDmg = Math.max(1, enemy.atk - Math.floor(stats.def / 2));
const reflect = Math.floor(eDmg * ((sp === 'counter' || sp === 'all') ? spBonus / 100 : 0));
const heal = Math.floor(maxHp * ((sp === 'heal' || sp === 'all') ? spBonus / 200 : 0));
const newEHp = Math.max(0, enemy.hp - dmg - bonus - reflect);
const newHp = Math.min(maxHp, Math.max(0, curHp - eDmg + heal));

const newLog = [...log];
newLog.push(`${isCrit ? 'ğŸ’¥ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«! ' : ''}${dmg}${bonus > 0 ? `+${bonus}` : ''}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`);
if (reflect > 0) newLog.push(`ğŸ”„åå°„${reflect}ï¼`);

if (newEHp <= 0) {
  sound('win');
  let rank = enemy.drop[Math.floor(Math.random() * enemy.drop.length)];
  if (Math.random() < ((sp === 'shell' || sp === 'all') ? spBonus / 100 : 0)) rank = Math.min(5, rank + 1);
  const expRate = (sp === 'exp' || sp === 'all') ? 1 + spBonus / 100 : 1;
  const expG = Math.floor(enemy.exp * expRate);
  let [nExp, nLv] = [player.exp + expG, player.level];
  while (nExp >= expNext(nLv)) { nExp -= expNext(nLv); nLv++; }
  newLog.push(`ğŸ‰å‹åˆ©ï¼ ${SHELLS[rank].icon}${SHELLS[rank].name}+1 ğŸ’«${expG}EXP`);
  if (nLv > player.level) { newLog.push(`â¬†ï¸ Lv${nLv}ã«ã‚¢ãƒƒãƒ—ï¼`); sound('levelup'); }
  setPlayer(p => ({ ...p, shells: { ...p.shells, [rank]: p.shells[rank] + 1 }, exp: nExp, level: nLv }));
  setHp(nLv > player.level ? getStats().mhp : newHp);
  setEnemy(null);
} else {
  setTimeout(() => sound('hit'), 200);
  newLog.push(`${enemy.name}ã®åæ’ƒï¼ ${eDmg}ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼${heal > 0 ? ` ğŸ’š+${heal}` : ''}`);
  if (newHp <= 0) { newLog.push('ğŸ’€æ•—åŒ—...'); sound('lose'); setHp(0); setEnemy(null); }
  else { setEnemy(e => ({ ...e, hp: newEHp })); setHp(newHp); }
}
setLog(newLog.slice(-5));
setTimeout(() => setAnim(false), 200);
```

};

const getTiming = (r) => {
const i = RARITY_LIST.indexOf(r);
return { spin: 1000 + i * 200, build: i >= 2 ? 1000 + i * 500 : 0 };
};

const pullItem = (rank) => {
if (player.shells[rank] < SHELLS[rank].itemCost) return;
sound(â€˜gachaâ€™);
setPlayer(p => ({ â€¦p, shells: { â€¦p.shells, [rank]: p.shells[rank] - SHELLS[rank].itemCost } }));
setGachaRank(rank); setGachaType(â€˜itemâ€™); setGachaPhase(â€˜spinâ€™);
let r = Math.random(), idx = 0;
ITEM_RATES[rank].forEach((rate, i) => { if (r > 0) { r -= rate; if (r <= 0) idx = i; } });
const item = ITEMS[rank][idx];
setGachaRarity(item.rarity);
const t = getTiming(item.rarity);
setTimeout(() => {
if (t.build > 0) { setGachaPhase(â€˜buildâ€™); sound(â€˜gachaRareâ€™); setTimeout(() => finishItem(item), t.build); }
else finishItem(item);
}, t.spin);
};

const finishItem = (item) => {
setGachaPhase(â€˜resultâ€™);
sound(â€˜gachaHitâ€™);
const idx = player.items.findIndex(x => x.id === item.id);
if (idx >= 0) {
const newLv = Math.min(10, (player.items[idx].lv || 1) + 1);
const newItems = [â€¦player.items]; newItems[idx] = { â€¦newItems[idx], lv: newLv };
setPlayer(p => ({ â€¦p, items: newItems }));
setResult({ â€¦item, lv: newLv, isUp: true });
} else {
setPlayer(p => ({ â€¦p, items: [â€¦p.items, { â€¦item, lv: 1 }] }));
setResult({ â€¦item, lv: 1, isUp: false });
}
};

const pullJob = (rank) => {
if (player.shells[rank] < SHELLS[rank].jobCost) return;
sound(â€˜gachaâ€™);
setPlayer(p => ({ â€¦p, shells: { â€¦p.shells, [rank]: p.shells[rank] - SHELLS[rank].jobCost } }));
setGachaRank(rank); setGachaType(â€˜jobâ€™); setGachaPhase(â€˜spinâ€™);
const byR = {}; Object.entries(JOBS).forEach(([id, j]) => { byR[j.rarity] = byR[j.rarity] || []; byR[j.rarity].push(id); });
let r = Math.random(), rarity = â€˜Nâ€™;
Object.entries(JOB_RATES[rank] || {}).forEach(([ra, rate]) => { if (r > 0) { r -= rate; if (r <= 0) rarity = ra; } });
const jobId = byR[rarity]?.[Math.floor(Math.random() * (byR[rarity]?.length || 1))] || â€˜fishermanâ€™;
setGachaRarity(JOBS[jobId].rarity);
const t = getTiming(JOBS[jobId].rarity);
setTimeout(() => {
if (t.build > 0) { setGachaPhase(â€˜buildâ€™); sound(â€˜gachaRareâ€™); setTimeout(() => finishJob(jobId), t.build); }
else finishJob(jobId);
}, t.spin);
};

const finishJob = (jobId) => {
setGachaPhase(â€˜resultâ€™);
sound(â€˜gachaHitâ€™);
const isNew = !player.unlockedJobs.includes(jobId);
const newLv = Math.min(10, (player.jobLevels[jobId] || 0) + 1);
setPlayer(p => ({
â€¦p,
unlockedJobs: isNew ? [â€¦p.unlockedJobs, jobId] : p.unlockedJobs,
jobLevels: { â€¦p.jobLevels, [jobId]: newLv },
}));
setResult({ type: â€˜jobâ€™, jobId, job: JOBS[jobId], lv: newLv, isNew });
};

const closeResult = () => { setResult(null); setGachaPhase(null); setGachaRarity(null); };

const handlePw = () => {
const d = decode(pwInput);
if (d) { setPlayer(d); setHp(null); setPwError(â€™â€™); setShowPwInput(false); setPwInput(â€™â€™); setScreen(â€˜homeâ€™); sound(â€˜levelupâ€™); }
else setPwError(â€˜ã˜ã‚…ã‚‚ã‚“ãŒ ã¡ãŒã„ã¾ã™â€™);
};

const ri = RARITY_LIST.indexOf(gachaRarity || â€˜Nâ€™);

// ã‚¿ã‚¤ãƒˆãƒ«
if (screen === â€˜titleâ€™) return (
<div style={{
minHeight: â€˜100vhâ€™,
background: â€˜linear-gradient(180deg, #000510 0%, #001030 30%, #002855 60%, #004080 100%)â€™,
fontFamily: â€˜â€œHiragino Kaku Gothic Proâ€, â€œYu Gothicâ€, sans-serifâ€™,
display: â€˜flexâ€™,
flexDirection: â€˜columnâ€™,
alignItems: â€˜centerâ€™,
justifyContent: â€˜centerâ€™,
position: â€˜relativeâ€™,
overflow: â€˜hiddenâ€™,
}}>
{/* æµ·ã®æ³¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */}
<div style={{ position: â€˜absoluteâ€™, bottom: 0, left: 0, right: 0, height: â€˜30%â€™, background: â€˜linear-gradient(180deg, transparent 0%, rgba(0,100,180,0.3) 50%, rgba(0,150,220,0.4) 100%)â€™, animation: â€˜wave 4s ease-in-out infiniteâ€™ }} />
<div style={{ position: â€˜absoluteâ€™, bottom: 0, left: 0, right: 0, height: â€˜25%â€™, background: â€˜linear-gradient(180deg, transparent 0%, rgba(0,80,150,0.2) 50%, rgba(0,120,200,0.3) 100%)â€™, animation: â€˜wave 3s ease-in-out infinite reverseâ€™ }} />

```
  {/* æµ®éŠã™ã‚‹æ³¡ */}
  {[...Array(15)].map((_, i) => (
    <div key={i} style={{
      position: 'absolute',
      width: 8 + Math.random() * 15,
      height: 8 + Math.random() * 15,
      borderRadius: '50%',
      background: 'radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4), rgba(100,200,255,0.1))',
      left: `${5 + Math.random() * 90}%`,
      bottom: `${Math.random() * 40}%`,
      animation: `bubble ${4 + Math.random() * 4}s ease-in-out infinite`,
      animationDelay: `${Math.random() * 3}s`,
    }} />
  ))}
  
  {/* å…‰ã®ç­‹ */}
  <div style={{ position: 'absolute', top: 0, left: '20%', width: '2px', height: '60%', background: 'linear-gradient(180deg, rgba(255,255,255,0.3), transparent)', transform: 'rotate(15deg)', animation: 'shimmer 3s ease-in-out infinite' }} />
  <div style={{ position: 'absolute', top: 0, left: '70%', width: '2px', height: '50%', background: 'linear-gradient(180deg, rgba(255,255,255,0.2), transparent)', transform: 'rotate(-10deg)', animation: 'shimmer 4s ease-in-out infinite 1s' }} />
  
  {/* ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ãƒ¢ãƒ¼ãƒ€ãƒ« */}
  {showPwInput && (
    <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.9)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 }}>
      <div style={{ background: 'linear-gradient(135deg, #0a1525 0%, #1a2a45 100%)', padding: 30, borderRadius: 20, border: '2px solid #FFD700', boxShadow: '0 0 40px rgba(255,215,0,0.3)', width: '90%', maxWidth: 380 }}>
        <div style={{ color: '#FFD700', fontSize: 20, textAlign: 'center', marginBottom: 20, textShadow: '0 0 10px rgba(255,215,0,0.5)' }}>ğŸ“œ ãµã£ã‹ã¤ã®ã˜ã‚…ã‚‚ã‚“</div>
        <textarea value={pwInput} onChange={e => setPwInput(e.target.value)} placeholder="ã˜ã‚…ã‚‚ã‚“ã‚’ ã«ã‚…ã†ã‚Šã‚‡ã..." style={{ width: '100%', height: 110, padding: 12, fontSize: 15, background: 'rgba(0,0,0,0.5)', border: '2px solid #4169E1', borderRadius: 10, color: '#fff', resize: 'none', boxSizing: 'border-box' }} />
        {pwError && <div style={{ color: '#ff6b6b', fontSize: 13, textAlign: 'center', marginTop: 10 }}>{pwError}</div>}
        <div style={{ display: 'flex', gap: 12, marginTop: 20 }}>
          <button onClick={() => { setShowPwInput(false); setPwInput(''); setPwError(''); }} style={{ flex: 1, padding: 12, background: 'rgba(100,100,100,0.5)', border: '1px solid #666', borderRadius: 10, color: '#fff', cursor: 'pointer', fontSize: 15 }}>ã‚‚ã©ã‚‹</button>
          <button onClick={handlePw} style={{ flex: 1, padding: 12, background: 'linear-gradient(135deg, #FFD700 0%, #FFA500 100%)', border: 'none', borderRadius: 10, color: '#1a1a2e', fontWeight: 'bold', cursor: 'pointer', fontSize: 15, boxShadow: '0 4px 15px rgba(255,215,0,0.4)' }}>ã‘ã£ã¦ã„</button>
        </div>
      </div>
    </div>
  )}
  
  {/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
  <div style={{ position: 'relative', zIndex: 10, textAlign: 'center', padding: '0 20px' }}>
    {/* ã‚¢ã‚¤ã‚³ãƒ³ç¾¤ */}
    <div style={{ display: 'flex', justifyContent: 'center', gap: 8, marginBottom: 25 }}>
      <span style={{ fontSize: 45, animation: 'float 3s ease-in-out infinite', filter: 'drop-shadow(0 0 10px rgba(255,200,100,0.5))' }}>ğŸš</span>
      <span style={{ fontSize: 55, animation: 'float 3s ease-in-out infinite 0.3s', filter: 'drop-shadow(0 0 15px rgba(100,200,255,0.6))' }}>ğŸ‰</span>
      <span style={{ fontSize: 45, animation: 'float 3s ease-in-out infinite 0.6s', filter: 'drop-shadow(0 0 10px rgba(255,100,100,0.5))' }}>ğŸ¦ˆ</span>
    </div>
    
    {/* ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ« */}
    <h1 style={{ 
      fontSize: 44, 
      fontWeight: 900,
      color: 'transparent',
      background: 'linear-gradient(180deg, #FFE566 0%, #FFD700 30%, #FF9500 70%, #FF6B00 100%)',
      backgroundClip: 'text',
      WebkitBackgroundClip: 'text',
      textShadow: '0 0 40px rgba(255,180,0,0.6), 0 4px 8px rgba(0,0,0,0.5)',
      marginBottom: 8,
      letterSpacing: 6,
      lineHeight: 1.2,
    }}>
      éš å²æµ·ä¼èª¬
    </h1>
    
    {/* è‹±èªã‚µãƒ– */}
    <div style={{
      fontSize: 11,
      color: '#87CEEB',
      letterSpacing: 8,
      marginBottom: 15,
      opacity: 0.8,
    }}>
      OKI OCEAN SAGA
    </div>
    
    {/* ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ« */}
    <div style={{
      fontSize: 15,
      color: '#fff',
      textShadow: '0 0 20px rgba(100,200,255,0.5)',
      marginBottom: 8,
      letterSpacing: 2,
    }}>
      ã€œ ç¥ã€…ã®çœ ã‚‹æµ·ã§ã€ä¼èª¬ã‚’ç¶™ã’ ã€œ
    </div>
    
    {/* ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼ */}
    <div style={{
      fontSize: 11,
      color: '#aaa',
      marginBottom: 40,
      letterSpacing: 1,
    }}>
      è²ã‚’é›†ã‚ã€è·æ¥­ã‚’æ¥µã‚ã€é¾ç¥ã®åŠ›ã‚’æ‰‹ã«å…¥ã‚Œã‚
    </div>
    
    {/* ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ */}
    <button 
      onClick={() => { sound('button'); setScreen('home'); }} 
      style={{ 
        padding: '18px 60px', 
        fontSize: 20, 
        fontWeight: 'bold',
        background: 'linear-gradient(180deg, #FFE566 0%, #FFD700 40%, #FF9500 100%)',
        border: 'none', 
        borderRadius: 50, 
        color: '#1a0a00',
        cursor: 'pointer', 
        marginBottom: 20,
        boxShadow: '0 6px 30px rgba(255,180,0,0.5), inset 0 2px 0 rgba(255,255,255,0.3)',
        letterSpacing: 4,
        transition: 'all 0.2s ease',
        position: 'relative',
        overflow: 'hidden',
      }}
      onMouseOver={(e) => { e.target.style.transform = 'scale(1.05)'; e.target.style.boxShadow = '0 8px 40px rgba(255,180,0,0.7)'; }}
      onMouseOut={(e) => { e.target.style.transform = 'scale(1)'; e.target.style.boxShadow = '0 6px 30px rgba(255,180,0,0.5)'; }}
    >
      âš”ï¸ å†’é™ºã‚’ã¯ã˜ã‚ã‚‹
    </button>
    
    {/* ã˜ã‚…ã‚‚ã‚“ãƒœã‚¿ãƒ³ */}
    <div>
      <button 
        onClick={() => { sound('button'); setShowPwInput(true); }} 
        style={{ 
          padding: '12px 35px', 
          fontSize: 13, 
          background: 'rgba(255,255,255,0.05)', 
          border: '2px solid rgba(135,206,235,0.5)', 
          borderRadius: 25, 
          color: '#87CEEB', 
          cursor: 'pointer',
          backdropFilter: 'blur(10px)',
          transition: 'all 0.2s ease',
        }}
        onMouseOver={(e) => { e.target.style.background = 'rgba(135,206,235,0.15)'; e.target.style.borderColor = '#87CEEB'; }}
        onMouseOut={(e) => { e.target.style.background = 'rgba(255,255,255,0.05)'; e.target.style.borderColor = 'rgba(135,206,235,0.5)'; }}
      >
        ğŸ“œ ãµã£ã‹ã¤ã®ã˜ã‚…ã‚‚ã‚“
      </button>
    </div>
    
    {/* ãƒ•ãƒƒã‚¿ãƒ¼ */}
    <div style={{ marginTop: 50, fontSize: 10, color: 'rgba(255,255,255,0.3)', letterSpacing: 1 }}>
      ğŸï¸ SHIMANEãƒ»OKI ISLANDS ğŸï¸
    </div>
  </div>
  
  {/* ã‚¿ã‚¤ãƒˆãƒ«ç”¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */}
  <style>{`
    @keyframes wave {
      0%, 100% { transform: translateY(0) translateX(0); }
      50% { transform: translateY(-15px) translateX(10px); }
    }
    @keyframes bubble {
      0%, 100% { transform: translateY(0) scale(1); opacity: 0.6; }
      50% { transform: translateY(-80px) scale(1.1); opacity: 0.3; }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-12px); }
    }
    @keyframes shimmer {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.6; }
    }
  `}</style>
</div>
```

);

// ãƒãƒˆãƒ«
if (screen === â€˜battleâ€™) return (
<div style={{ minHeight: â€˜100vhâ€™, background: â€˜linear-gradient(180deg,#0a1628,#1a3a5c)â€™, fontFamily: â€˜sans-serifâ€™, padding: 15 }}>
<div style={{ display: â€˜flexâ€™, justifyContent: â€˜space-betweenâ€™, alignItems: â€˜centerâ€™, marginBottom: 15 }}>
<div style={{ background: â€˜rgba(0,0,0,0.5)â€™, padding: 10, borderRadius: 10, border: `2px solid ${job.color}` }}>
<div style={{ color: job.color, fontSize: 12 }}>{job.icon} {job.name} JLv{jLv} / PLv{player.level}</div>
<div style={{ width: 120, height: 12, background: â€˜#222â€™, borderRadius: 6, overflow: â€˜hiddenâ€™, marginTop: 5 }}>
<div style={{ width: `${curHp / maxHp * 100}%`, height: â€˜100%â€™, background: â€˜#f44â€™ }} />
</div>
<div style={{ color: â€˜#fffâ€™, fontSize: 10 }}>HP:{curHp}/{maxHp} æ”»:{stats.atk} é˜²:{stats.def}</div>
</div>
<button onClick={() => { sound(â€˜buttonâ€™); setEnemy(null); setLog([]); setScreen(â€˜homeâ€™); }} style={{ padding: â€˜8px 15pxâ€™, background: â€˜#555â€™, border: â€˜noneâ€™, borderRadius: 15, color: â€˜#fffâ€™, cursor: â€˜pointerâ€™, fontSize: 12 }}>é€ƒã’ã‚‹</button>
</div>

```
  {enemy && (
    <div style={{ textAlign: 'center', marginBottom: 20 }}>
      {enemy.boss && (
        <div style={{ color: enemy.glow, fontSize: 14, fontWeight: 'bold', marginBottom: 5, textShadow: `0 0 10px ${enemy.glow}` }}>
          âš ï¸ BOSS âš ï¸
        </div>
      )}
      <div style={{ 
        fontSize: 80, 
        filter: enemy.boss ? `drop-shadow(0 0 30px ${enemy.glow}) drop-shadow(0 0 60px ${enemy.glow})` : `drop-shadow(0 0 20px ${enemy.color})`,
        animation: enemy.boss ? 'bossPulse 1s infinite' : 'none'
      }}>{enemy.icon}</div>
      <div style={{ color: enemy.boss ? enemy.glow : '#fff', fontSize: 16, fontWeight: enemy.boss ? 'bold' : 'normal' }}>{enemy.name}</div>
      <div style={{ width: 150, height: 12, background: '#222', borderRadius: 6, overflow: 'hidden', margin: '5px auto', border: enemy.boss ? `2px solid ${enemy.glow}` : 'none' }}>
        <div style={{ width: `${enemy.hp / enemy.maxHp * 100}%`, height: '100%', background: enemy.boss ? enemy.glow : enemy.color }} />
      </div>
      <div style={{ color: '#aaa', fontSize: 11 }}>HP:{enemy.hp}/{enemy.maxHp} æ”»:{enemy.atk} é˜²:{enemy.def}</div>
    </div>
  )}
  
  {!enemy && log.length > 0 && <div style={{ textAlign: 'center', fontSize: 50, marginBottom: 20 }}>{curHp > 0 ? 'ğŸ‰' : 'ğŸ’€'}</div>}
  
  <div style={{ background: 'rgba(0,0,0,0.5)', borderRadius: 10, padding: 10, minHeight: 100, marginBottom: 15 }}>
    {log.map((l, i) => <div key={i} style={{ 
      color: l.includes('å‹åˆ©') || l.includes('ã‚¢ãƒƒãƒ—') ? '#FFD700' : l.includes('æ•—åŒ—') ? '#f44' : l.includes('ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«') ? '#FF69B4' : l.includes('BOSS') ? '#FF4500' : '#fff', 
      fontSize: 13, padding: 2 
    }}>{l}</div>)}
  </div>
  
  <div style={{ display: 'flex', gap: 10, justifyContent: 'center' }}>
    {enemy ? (
      <button onClick={doAttack} disabled={anim} style={{ padding: '15px 40px', fontSize: 18, background: anim ? '#555' : '#f44', border: 'none', borderRadius: 25, color: '#fff', fontWeight: 'bold', cursor: anim ? 'default' : 'pointer' }}>âš”ï¸ æ”»æ’ƒ</button>
    ) : (
      <>
        <button onClick={startBattle} disabled={curHp <= 0} style={{ padding: '12px 25px', fontSize: 14, background: curHp <= 0 ? '#555' : '#4169E1', border: 'none', borderRadius: 20, color: '#fff', cursor: curHp <= 0 ? 'default' : 'pointer' }}>ğŸŒŠ æ¬¡ã¸</button>
        <button onClick={() => { sound('button'); setScreen('home'); }} style={{ padding: '12px 25px', fontSize: 14, background: '#228B22', border: 'none', borderRadius: 20, color: '#fff', cursor: 'pointer' }}>ğŸ  æˆ»ã‚‹</button>
      </>
    )}
  </div>
  
  <style>{`
    @keyframes bossPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
  `}</style>
</div>
```

);

// ãƒ›ãƒ¼ãƒ 
return (
<div style={{ minHeight: â€˜100vhâ€™, background: â€˜linear-gradient(180deg,#1a1a2e,#16213e)â€™, fontFamily: â€˜sans-serifâ€™, padding: 12 }}>
{/* ã‚¬ãƒãƒ£æ¼”å‡º */}
{(gachaPhase === â€˜spinâ€™ || gachaPhase === â€˜buildâ€™) && (
<div style={{ position: â€˜fixedâ€™, inset: 0, background: gachaPhase === â€˜buildâ€™ ? `radial-gradient(circle,${RARITY_COLOR[gachaRarity]}44,#000)` : â€˜#000â€™, display: â€˜flexâ€™, alignItems: â€˜centerâ€™, justifyContent: â€˜centerâ€™, zIndex: 100 }}>
{gachaPhase === â€˜spinâ€™ && <div style={{ fontSize: 100, animation: â€˜spin 1s linear infiniteâ€™ }}>{gachaType === â€˜jobâ€™ ? â€˜ğŸ‘¤â€™ : SHELLS[gachaRank]?.icon}</div>}
{gachaPhase === â€˜buildâ€™ && (
<div style={{ textAlign: â€˜centerâ€™, position: â€˜relativeâ€™ }}>
{ri >= 2 && <div style={{ position: â€˜absoluteâ€™, top: â€˜50%â€™, left: â€˜50%â€™, transform: â€˜translate(-50%,-50%)â€™, width: 200, height: 200, border: `3px solid ${RARITY_COLOR[gachaRarity]}`, borderRadius: â€˜50%â€™, borderTopColor: â€˜transparentâ€™, animation: â€˜spin 1s linear infiniteâ€™ }} />}
{ri >= 4 && <div style={{ position: â€˜absoluteâ€™, top: â€˜50%â€™, left: â€˜50%â€™, transform: â€˜translate(-50%,-50%)â€™, width: 250, height: 250, background: â€˜conic-gradient(red,yellow,lime,aqua,blue,magenta,red)â€™, borderRadius: â€˜50%â€™, animation: â€˜spin 2s linear infiniteâ€™, opacity: 0.3, filter: â€˜blur(10px)â€™ }} />}
<div style={{ fontSize: 80, position: â€˜relativeâ€™, animation: ri >= 3 ? â€˜shake 0.1s infiniteâ€™ : â€˜pulse 0.5s infiniteâ€™, filter: `drop-shadow(0 0 30px ${RARITY_COLOR[gachaRarity]})` }}>â“</div>
<div style={{ color: RARITY_COLOR[gachaRarity], fontSize: 20, marginTop: 20, fontWeight: â€˜boldâ€™ }}>
{ri >= 5 ? â€˜ï¼ï¼ä¼èª¬ã®è¼ãï¼ï¼â€™ : ri >= 4 ? â€˜ï¼ç¥ã€…ã—ã„å…‰ï¼â€™ : ri >= 3 ? â€˜é‡‘è‰²ã®å…‰ãŒï¼â€™ : â€˜ç´«ã®å…‰â€¦â€™}
</div>
</div>
)}
</div>
)}

```
  {/* çµæœè¡¨ç¤º */}
  {result && gachaPhase === 'result' && (
    <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.95)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 }}>
      <div style={{ textAlign: 'center', padding: 20 }}>
        {result.type === 'job' ? (
          <>
            {result.isNew ? <div style={{ color: '#0f0', fontSize: 18, marginBottom: 10 }}>ğŸ†• NEW!</div> : <div style={{ color: '#0ff', fontSize: 18, marginBottom: 10 }}>â¬†ï¸ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼</div>}
            <div style={{ color: RARITY_COLOR[result.job.rarity], fontSize: 18 }}>â˜…{result.job.rarity}â˜…</div>
            <div style={{ fontSize: 80, margin: '15px 0', filter: `drop-shadow(0 0 30px ${result.job.color})` }}>{result.job.icon}</div>
            <div style={{ color: '#fff', fontSize: 24, marginBottom: 5 }}>{result.job.name}</div>
            <div style={{ color: '#FFD700', fontSize: 20 }}>è·æ¥­Lv.{result.lv}</div>
            <div style={{ color: '#aaa', fontSize: 12, marginTop: 10 }}>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹+{((result.lv - 1) * 15)}% / ç‰¹æ®ŠåŠ¹æœ+{15 + (result.lv - 1) * 8}%</div>
          </>
        ) : (
          <>
            {result.isUp ? <div style={{ color: '#0ff', fontSize: 18, marginBottom: 10 }}>â¬†ï¸ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼</div> : <div style={{ color: '#0f0', fontSize: 18, marginBottom: 10 }}>ğŸ†• NEW!</div>}
            <div style={{ color: RARITY_COLOR[result.rarity], fontSize: 18 }}>â˜…{result.rarity}â˜…</div>
            <div style={{ fontSize: 60, margin: '15px 0' }}>{TYPE_ICON[result.type]}</div>
            <div style={{ color: '#888', fontSize: 12 }}>{TYPE_NAME[result.type]}</div>
            <div style={{ color: '#fff', fontSize: 22, marginBottom: 5 }}>{result.name}</div>
            <div style={{ color: '#FFD700', fontSize: 18 }}>Lv.{result.lv}</div>
            <div style={{ color: '#aaa', fontSize: 12, marginTop: 10 }}>
              æ”»+{Math.floor(result.atk * (1 + (result.lv - 1) * 0.25))} é˜²+{Math.floor(result.def * (1 + (result.lv - 1) * 0.25))} HP+{Math.floor(result.hp * (1 + (result.lv - 1) * 0.25))}
            </div>
          </>
        )}
        <button onClick={() => { sound('button'); closeResult(); }} style={{ marginTop: 25, padding: '12px 40px', background: '#FFD700', border: 'none', borderRadius: 20, fontWeight: 'bold', cursor: 'pointer' }}>OK</button>
      </div>
    </div>
  )}

  {/* ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤º */}
  {showPw && (
    <div style={{ position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.9)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 100 }}>
      <div style={{ background: '#1a1a2e', padding: 25, borderRadius: 15, border: '2px solid #FFD700', width: '90%', maxWidth: 400, textAlign: 'center' }}>
        <div style={{ color: '#FFD700', fontSize: 18, marginBottom: 15 }}>ğŸ“œ ãµã£ã‹ã¤ã®ã˜ã‚…ã‚‚ã‚“</div>
        <div style={{ background: '#0a0a1a', padding: 15, borderRadius: 8, marginBottom: 15 }}>
          <div style={{ color: '#fff', fontSize: 16, fontFamily: 'monospace', wordBreak: 'break-all', lineHeight: 1.8 }}>{encode(player)}</div>
        </div>
        <div style={{ color: '#888', fontSize: 11, marginBottom: 15 }}>Lv{player.level} / è·æ¥­{player.unlockedJobs.length}ç¨® / è£…å‚™{player.items.length}å€‹</div>
        <button onClick={() => navigator.clipboard?.writeText(encode(player))} style={{ padding: '8px 20px', background: '#4169E1', border: 'none', borderRadius: 15, color: '#fff', cursor: 'pointer', marginRight: 10 }}>ã‚³ãƒ”ãƒ¼</button>
        <button onClick={() => { sound('button'); setShowPw(false); }} style={{ padding: '8px 20px', background: '#FFD700', border: 'none', borderRadius: 15, fontWeight: 'bold', cursor: 'pointer' }}>ã¨ã˜ã‚‹</button>
      </div>
    </div>
  )}

  {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: 12, flexWrap: 'wrap', gap: 8 }}>
    <div style={{ background: 'rgba(0,0,0,0.5)', padding: 10, borderRadius: 10, border: `2px solid ${job.color}`, display: 'flex', alignItems: 'center', gap: 10 }}>
      <span style={{ fontSize: 24 }}>{job.icon}</span>
      <div>
        <div style={{ color: job.color, fontSize: 11 }}>{job.name} JLv{jLv}</div>
        <div style={{ color: '#FFD700', fontSize: 14, fontWeight: 'bold' }}>PLv{player.level}</div>
      </div>
    </div>
    <div style={{ display: 'flex', gap: 6 }}>
      <button onClick={() => { sound('button'); setShowPw(true); }} style={{ padding: '8px 12px', background: 'rgba(255,215,0,0.2)', border: '1px solid #FFD700', borderRadius: 15, color: '#FFD700', cursor: 'pointer', fontSize: 11 }}>ğŸ“œ</button>
      <button onClick={() => { sound('heal'); setHp(maxHp); }} style={{ padding: '8px 12px', background: '#00CED1', border: 'none', borderRadius: 15, color: '#fff', cursor: 'pointer', fontSize: 11 }}>ğŸ’šå›å¾©</button>
      <button onClick={startBattle} disabled={curHp <= 0} style={{ padding: '8px 12px', background: curHp <= 0 ? '#555' : '#f44', border: 'none', borderRadius: 15, color: '#fff', cursor: curHp <= 0 ? 'default' : 'pointer', fontSize: 11 }}>âš”ï¸æˆ¦é—˜</button>
    </div>
  </div>

  {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */}
  <div style={{ background: 'rgba(0,0,0,0.4)', borderRadius: 10, padding: 10, marginBottom: 12 }}>
    <div style={{ color: '#fff', fontSize: 12, marginBottom: 5 }}>HP:{curHp}/{maxHp} æ”»:{stats.atk} é˜²:{stats.def}</div>
    <div style={{ width: '100%', height: 6, background: '#222', borderRadius: 3, overflow: 'hidden' }}>
      <div style={{ width: `${curHp / maxHp * 100}%`, height: '100%', background: '#f44' }} />
    </div>
  </div>

  {/* è²ï¼ˆåå‰è¡¨ç¤ºè¿½åŠ ï¼‰ */}
  <div style={{ display: 'flex', gap: 4, marginBottom: 12, flexWrap: 'wrap' }}>
    {Object.entries(SHELLS).map(([r, s]) => (
      <div key={r} style={{ background: `${s.color}22`, border: `1px solid ${s.color}`, borderRadius: 8, padding: '6px 8px', textAlign: 'center', minWidth: 55, flex: '1 1 auto' }}>
        <div style={{ fontSize: 18 }}>{s.icon}</div>
        <div style={{ color: s.color, fontSize: 10, fontWeight: 'bold' }}>{s.name}</div>
        <div style={{ color: '#fff', fontSize: 16, fontWeight: 'bold' }}>{player.shells[r]}</div>
      </div>
    ))}
  </div>

  {/* ã‚¿ãƒ– */}
  <div style={{ display: 'flex', gap: 4, marginBottom: 12 }}>
    {[['gacha', 'ğŸ°ã‚¬ãƒãƒ£'], ['jobs', 'ğŸ‘¤è·æ¥­'], ['items', 'ğŸ“¦è£…å‚™']].map(([id, label]) => (
      <button key={id} onClick={() => { sound('button'); setTab(id); }} style={{ flex: 1, padding: 10, background: tab === id ? '#4169E1' : '#333', border: tab === id ? '2px solid #87CEEB' : '2px solid #444', borderRadius: 8, color: '#fff', fontSize: 12, cursor: 'pointer' }}>{label}</button>
    ))}
  </div>

  {/* ã‚¬ãƒãƒ£ã‚¿ãƒ– */}
  {tab === 'gacha' && (
    <div style={{ background: 'rgba(0,0,0,0.4)', borderRadius: 10, padding: 12 }}>
      <div style={{ color: '#FFD700', fontSize: 13, marginBottom: 8, fontWeight: 'bold' }}>ğŸ° è£…å‚™ã‚¬ãƒãƒ£</div>
      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5,1fr)', gap: 6, marginBottom: 15 }}>
        {Object.entries(SHELLS).map(([r, s]) => {
          const can = player.shells[r] >= s.itemCost;
          return <button key={r} onClick={() => can && pullItem(+r)} disabled={!can} style={{ padding: 6, background: can ? s.color : '#333', border: 'none', borderRadius: 8, color: '#fff', opacity: can ? 1 : 0.5, cursor: can ? 'pointer' : 'default' }}>
            <div style={{ fontSize: 16 }}>{s.icon}</div>
            <div style={{ fontSize: 8 }}>{s.name}</div>
            <div style={{ fontSize: 9, marginTop: 2 }}>{s.itemCost}å€‹</div>
          </button>;
        })}
      </div>
      <div style={{ color: '#9932CC', fontSize: 13, marginBottom: 8, fontWeight: 'bold' }}>ğŸ‘¤ è·æ¥­ã‚¬ãƒãƒ£</div>
      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(5,1fr)', gap: 6 }}>
        {Object.entries(SHELLS).map(([r, s]) => {
          const can = player.shells[r] >= s.jobCost;
          return <button key={r} onClick={() => can && pullJob(+r)} disabled={!can} style={{ padding: 6, background: can ? '#9932CC' : '#333', border: 'none', borderRadius: 8, color: '#fff', opacity: can ? 1 : 0.5, cursor: can ? 'pointer' : 'default' }}>
            <div style={{ fontSize: 16 }}>ğŸ‘¤</div>
            <div style={{ fontSize: 8 }}>{s.name}</div>
            <div style={{ fontSize: 9, marginTop: 2 }}>{s.jobCost}å€‹</div>
          </button>;
        })}
      </div>
    </div>
  )}

  {/* è·æ¥­ã‚¿ãƒ– */}
  {tab === 'jobs' && (
    <div style={{ background: 'rgba(0,0,0,0.4)', borderRadius: 10, padding: 12 }}>
      <div style={{ color: '#9932CC', fontSize: 13, marginBottom: 10, fontWeight: 'bold' }}>ğŸ‘¤ è·æ¥­ ({player.unlockedJobs.length}/10)</div>
      <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2,1fr)', gap: 8, maxHeight: 350, overflowY: 'auto' }}>
        {Object.entries(JOBS).map(([id, j]) => {
          const unlocked = player.unlockedJobs.includes(id);
          const active = player.currentJob === id;
          const lv = player.jobLevels[id] || 1;
          return <button key={id} onClick={() => { if (unlocked) { sound('button'); setPlayer(p => ({ ...p, currentJob: id })); }}} disabled={!unlocked} style={{ padding: 10, background: active ? j.color : unlocked ? `${j.color}33` : '#222', border: active ? '2px solid #FFD700' : '1px solid #444', borderRadius: 8, color: '#fff', opacity: unlocked ? 1 : 0.4, cursor: unlocked ? 'pointer' : 'default', textAlign: 'left' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>
              <span style={{ fontSize: 24 }}>{unlocked ? j.icon : 'â“'}</span>
              <div>
                <div style={{ fontSize: 10, color: RARITY_COLOR[j.rarity] }}>{j.rarity}</div>
                <div style={{ fontSize: 12, fontWeight: 'bold' }}>{unlocked ? j.name : '???'}</div>
                {unlocked && <div style={{ fontSize: 10, color: '#FFD700' }}>Lv{lv}</div>}
              </div>
            </div>
            {active && <div style={{ fontSize: 9, color: '#FFD700', marginTop: 5 }}>â–¶ä½¿ç”¨ä¸­</div>}
          </button>;
        })}
      </div>
    </div>
  )}

  {/* è£…å‚™ã‚¿ãƒ– */}
  {tab === 'items' && (
    <div style={{ background: 'rgba(0,0,0,0.4)', borderRadius: 10, padding: 12 }}>
      <div style={{ color: '#FFD700', fontSize: 13, marginBottom: 10, fontWeight: 'bold' }}>ğŸ“¦ è£…å‚™ ({player.items.length})</div>
      {player.items.length === 0 ? <div style={{ color: '#666', textAlign: 'center', padding: 20 }}>è£…å‚™ãªã—</div> : (
        <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2,1fr)', gap: 8, maxHeight: 350, overflowY: 'auto' }}>
          {player.items.map((it, i) => {
            const b = 1 + ((it.lv || 1) - 1) * 0.25;
            return <div key={i} style={{ background: `${RARITY_COLOR[it.rarity]}22`, border: `1px solid ${RARITY_COLOR[it.rarity]}`, borderRadius: 8, padding: 8 }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>
                <span style={{ fontSize: 20 }}>{TYPE_ICON[it.type]}</span>
                <div>
                  <div style={{ fontSize: 9, color: RARITY_COLOR[it.rarity] }}>{it.rarity} {TYPE_NAME[it.type]}</div>
                  <div style={{ fontSize: 11, color: '#fff' }}>{it.name}</div>
                  <div style={{ fontSize: 10, color: '#FFD700' }}>Lv{it.lv || 1}</div>
                </div>
              </div>
              <div style={{ fontSize: 9, color: '#aaa', marginTop: 5 }}>
                æ”»+{Math.floor(it.atk * b)} é˜²+{Math.floor(it.def * b)} HP+{Math.floor(it.hp * b)}
              </div>
            </div>;
          })}
        </div>
      )}
    </div>
  )}

  <style>{`
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes pulse { 0%,100% { transform: scale(1); } 50% { transform: scale(1.1); } }
    @keyframes shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
  `}</style>
</div>
```

);
}
